local assetHelper = asset.require("util/asset_helper")
--local earthTransforms = asset.require('scene/solarsystem/planets/earth/transforms')
asset.require("spice/base")

local HNMKernel = asset.localResource("./kernels/HNM.tf")

-- Barycenter of the solar system, expressed in the Galactic frame
local SolarSystemBarycenter = {
    Identifier = "SolarSystemBarycenter",
    -- No parent; this node is attached to the scene graph root
    TimeFrame = { -- Using Spice kernels for 1850-2150
        Type = "TimeFrameInterval",
        Start = "1850-JAN-01",
        End = "2150-JAN-01"
    },
    GUI = {
        Name = "Solar System Barycenter",
        Path = "/Solar System",
        Description = [[Barycenter of the solar system, expressed in the Galactic frame]],
        Hidden = true
    }
}

-- Spice frame for the Sun
local SunIAU = {
    Identifier = "SunIAU",
    Parent = SolarSystemBarycenter.Identifier,
    Transform = {
        Translation = {
            Type = "SpiceTranslation",
            Target = "SUN",
            Observer = "SSB"
        },
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "IAU_SUN",
            DestinationFrame = "GALACTIC"
        }
    },
    GUI = {
        Name = "SUN IAU",
        Path = "/Solar System/Sun",
        Description = [[Spice frame for the Sun]],
        Hidden = true
    }
}

local SunECLIPJ2000 = {
    Identifier = "SunECLIPJ2000",
    Parent = SolarSystemBarycenter.Identifier,
    Transform = {
        Translation = {
            Type = "SpiceTranslation",
            Target = "SUN",
            Observer = "SSB"
        },
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "ECLIPJ2000",
            DestinationFrame = "GALACTIC"
        }
    },
    GUI = {
        Name = "SUN J2000",
        Path = "/Solar System/Sun",
        Description = [[Spice rotation for Mean ecliptic and equinox of J2000]],
        Hidden = true
    }
}

local HNMReferenceFrame = {
    Identifier = "HNMReferenceFrame",
    Parent = SolarSystemBarycenter.Identifier,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "HEEQ180",
            DestinationFrame = "GALACTIC",
            Kernels = HNMKernel
        }
    },
    GUI = {
        Name = "HNM Reference Frame",
        Path = "/Solar System/Sun",
        Hidden = true
    }
}

assetHelper.registerSceneGraphNodesAndExport(asset, { SolarSystemBarycenter, SunIAU, SunECLIPJ2000, HNMReferenceFrame })


asset.meta = {
    Name = "Sun Transforms",
    Version = "1.0",
    Description = [[ Sun transforms: Solar System Barycenter, SUN IAU and
    SUN J2000]],
    Author = "OpenSpace Team",
    URL = "http://openspaceproject.com",
    License = "MIT license",
    Identifiers = {"SolarSystemBarycenter", "SunIAU", "SunECLIPJ2000", "HNMReferenceFrame"}
}
