local assetHelper = asset.require('util/asset_helper')
local sunTransforms = asset.require('scene/solarsystem/sun/transforms')

asset.require("spice/base")
asset.require('scene/solarsystem/missions/jwst/Lagrange_points')
local transforms = asset.require('scene/solarsystem/missions/jwst/L2')

local JWSTKernel = {
    "C:/Users/ElmQPC/Desktop/Malin/develop/OpenSpace/sync/http/JWST_kernels/1/jwst_horizons_20200101_20240101_v01.bsp"
}

local JWSTPosition = {
    Identifier = "JWSTPosition",
    Parent = transforms.L2.Identifier,
    Transform = {
        Translation = {
            Type = "SpiceTranslation",
            Target = "JWST", 
            Observer = "392", -- L2
            Kernels = JWSTKernel
        },
    },
    GUI = {
        Name = "James Webb Space Telescope Position",
        Path = "/Solar System/Missions/JWST",
        Hidden = true,
    }
}

local JWSTModel = {
    Identifier = "JWSTModel",
    Parent = JWSTPosition.Identifier,
    Transform = {
        Rotation = {
            Type = "FixedRotation",
            Attached = "JWSTModel",
            XAxis = { 0.01, -1.0, 0.56 },
            XAxisOrthogonal = true,
            YAxisInvert = true,
            YAxis = sunTransforms.SolarSystemBarycenter.Identifier
        }
    },
    Renderable = {
        Type = "RenderableModel",
        GeometryFile = "C:/Users/ElmQPC/Desktop/Malin/develop/WIP/data/JWST_model/3/JWSTFBX.fbx",
        EnableAnimation = true,
        AnimationStartTime = "2021 10 31 00:00:00",
        AnimationMode = "BounceFromStart",
        LightSources = {
            {
                Type = "SceneGraphLightSource",
                Identifier = "Sun",
                Node = sunTransforms.SolarSystemBarycenter.Identifier,
                Intensity = 1.0
            }
        },
        PerformShading = true,
        DisableFaceCulling = true
    },
    GUI = {
        Name = "James Webb Space Telecope",
        Path = "/Solar System/Missions/JWST",
    }
}

local JWSTTrail = {
    Identifier = "JWSTTrail",
    Parent = transforms.L2.Identifier,
    Renderable = {
        Type = "RenderableTrailOrbit",
        Translation = {
            Type = "SpiceTranslation",
            Target = "JWST", 
            Observer = "392", -- L2
            Kernels = JWSTKernel
        },
        Color = { 0.9, 0.9, 0.0 },
		Period = 91.3105,
        Resolution = 100
    },
    GUI = {
        Name = "James Webb Space Telescope Trail",
        Path = "/Solar System/Missions/JWST"
    }
}

assetHelper.registerSceneGraphNodesAndExport(asset, {
	JWSTTrail,
    JWSTPosition,
    JWSTModel
})