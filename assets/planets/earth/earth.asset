local Sun = asset.import('sun');
local AssetHelper = asset.import('assethelper')
local SpiceBase = asset.import('spice/base')

asset.EarthBarycenter = {
    Name = "EarthBarycenter",
    Parent = Sun.SolarSystemBarycenter.Name,
    Transform = {
        Translation = {
            Type = "SpiceTranslation",
            Body = "EARTH",
            Observer = "SUN",
            Kernels = "${OPENSPACE_DATA}/spice/de430_1850-2150.bsp"
        }
    }
}

asset.EarthInertial = {
    -- The default reference frame for Earth-orbiting satellites
    Name = "EarthInertial",
    Parent = asset.EarthBarycenter.Name,
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "J2000",
            DestinationFrame = "GALACTIC",
        }
    },
}

asset.Earth = {
    Name = "Earth",
    Parent = asset.EarthBarycenter.Name,
    Renderable = {
        Type = "RenderablePlanet",
        Frame = "IAU_EARTH",
        Body = "EARTH",
        Geometry = {
            Type = "SimpleSphere",
            Radius = 6.371E6,
            Segments = 100
        },
        Textures = {
            Type = "simple",
            --Color = resource("textures/earth_bluemarble.jpg"),
            Color = asset.syncedResource("textures/earth_bluemarble.jpg"),
            Night = asset.syncedResource("textures/earth_night.jpg"),
            Height = asset.syncedResource("textures/earth_bluemarble_height.jpg")
        },
        Atmosphere = {
            Type = "Nishita", -- for example, values missing etc etc
            MieFactor = 1.0,
            MieColor = {1.0, 1.0, 1.0}
        }
    },
    Tag = {"planet_solarSystem", "planet_terrestrial"},
    Transform = {
        Rotation = {
            Type = "SpiceRotation",
            SourceFrame = "IAU_EARTH",
            DestinationFrame = "GALACTIC",
        },
        Scale = {
            Type = "StaticScale",
            Scale = 1,
        },
    },
    GuiName = "/Solar/Planets/Earth"

}

asset.EarthTrail = {
    Name = "EarthTrail",
    Parent = Sun.SolarSystemBarycenter.Name,
    Renderable = {
        Type = "RenderableTrailOrbit",
        Translation = {
            Type = "SpiceTranslation",
            Body = "EARTH",
            Observer = "SUN"
        },
        Color = { 0.5, 0.8, 1.0 },
        -- StartTime = "2016 JUN 01 12:00:00.000",
        -- EndTime = "2017 JAN 01 12:00:00.000",
        -- SampleInterval = 3600
        Period = 365.242,
        Resolution = 1000,
        Tag = {"planetTrail_solarSystem", "planetTrail_terrestrial"}
    },
    GuiName = "/Solar/EarthTrail",
}

asset.EarthMarker = {
    Name = "EarthMarker",
    Parent = asset.Earth.Name,
    Renderable = {
        Type = "RenderablePlane",
        Size = 3.0E11,
        Origin = "Center",
        Billboard = true,
        Texture = asset.syncedResource("textures/marker.png"),
        BlendMode = "Additive"
    }
}


AssetHelper.registerSceneGraphNodes(asset, {
    asset.EarthBarycenter,
    asset.EarthInertial,
    asset.Earth,
    asset.EarthTrail,
    asset.EarthMarker
})