local assetHelper = asset.require('util/asset_helper')
local sunTransforms = asset.require('scene/solarsystem/sun/transforms')
local transforms = asset.require('scene/solarsystem/planets/earth/transforms')

local transferFunctions = asset.localResource("transferfunctions")
local masVelocityColorTable = transferFunctions .. "/velocity_fieldlines.txt"
local masDensityColorTable = transferFunctions .. "/density_fieldlines.txt"

local fieldlinesDirectory = 'D:/data/2000_01_01_event/cdf'
--local fieldlinesDirectory = 'C:/Users/eolsson/Documents/openspace/data/20000101/osfls'
--local seedPointDirectory = 'D:/data/2000_01_01_event/seedpoints'
local seedPointDirectory = 'D:/data/2000_01_01_event/seedpoints'

--local sunRadius = 6.957E8
local earthRadius = 6378137


-- Fieldlies from binaries
local fieldlines = {
    Identifier = "Earth_BATSRUS_Fieldlines",
    Parent = transforms.GSMReferenceFrame.Identifier,
    Renderable = {
        Type = "RenderableFieldlinesSequence",
        SourceFolder = fieldlinesDirectory,
        SeedPointDirectory = seedPointDirectory,
        TracingVariable = 'b',
        --OutputFolder = "C:/Users/eolsson/Documents/openspace/data/20000101/osfls/",
        
        -- FlowEnabled = false,
        -- LineWidth = 1.0;
        AlphaBlendlingEnabled = false,
        --InputFileType = "osfls",
        InputFileType = "CDF",

        ColorTablePaths = {
            masDensityColorTable,
            masVelocityColorTable,
        },
        ColorTableRanges = {
            { 0, 10 },
            { 100, 2000 }
        },
        ExtraVariables = {
            "rho",
            "p",
            "t"
        },
        ManualTimeOffset = -14400.0,
        LoadAtRuntime = true,
        ScaleToMeters = 1.0,
        SecondsBefore = 24*60*60,
        SecondsAfter = 24*60*60,
        SimulationModel = "batsrus",
        Color = {
            Uniform = {1.0, 0.0, 0.5, 1}
        }
    },
    GUI = {
        Path = "/Solar System/Heliosphere",
        Name = "Batsrus Fieldlines"
    },
    Transform = {
        Scale = {
            Type = "StaticScale",
            Scale = 1
        }
    }
} 

assetHelper.registerSceneGraphNodesAndExport(asset, { fieldlines })

asset.meta = {
    Name = "CDF fieldlines files Bastille Day",
    Version = "1.0",
    Description = " Magnetic fieldlines",
    Author = "OpenSpace team",
    URL = "",
    License = ""
}